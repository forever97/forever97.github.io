---
title: SAAA
date: 2020-08-05 15:13:50
tags: [VQA, attention, 2017]
mathjax: true
cover: http://m.qpic.cn/psc?/V10nbMUG2wnlL5/bqQfVz5yrrGYSXMvKr.cqTJIErA9B73q.Bq1wDWJi2j7inLZWBvcIbYwBCGjM39RZyxBo7GAbqHlOX5ZR0LuNTQOv2Gx5kuNigeIhKWmd2o!/b&bo=AAWJAwAAAAABB68!&rf=viewer_4
---
[Paper Download Address](https://arxiv.org/pdf/1704.03162.pdf)

文章提出了一个相对简单的结构，经过精心的训练能达到SOTA，整体结构如图：

![](http://m.qpic.cn/psc?/V10nbMUG3EIcUi/bqQfVz5yrrGYSXMvKr.cqVBaOrsaro1k23L38nKVvz.BJsT4tcT96jKFLmshCyGhWF4I9oXgEh2BbNDW2.i2ZO3APcKBqbFhTCED*9ysJSo!/b&bo=rgRfAQAAAAADB9Y!&rf=viewer_4)

用LSTM对问题进行编码，用ResNet获取图片的特征，然后用soft attention计算multiple glimpses图像特征，最后进行分类

## Method

### Image embedding

用预训练的CNN来计算图片表示，作者使用的是ResNet，取最后一个池化层，得到的特征大小是14×14×2048维的，然后再对深度维度进行l2范数约束

### Question embedding

将问题标记并嵌入到长度为p的向量中，然后用LSTM处理

### Stacked attention

和[SAN][1]十分相似，计算图像特征空间维度上的多重注意力分布

[1]:https://forever97.github.io/2020/08/04/1511-02274/

![](http://m.qpic.cn/psc?/V10nbMUG3EIcUi/TmEUgtj9EK6.7V8ajmQrEEuYgCvYHeZjUcrOD2Qo2SlnQnrg.Sok7FhJT*OBU7q3Dc80c31dc2YvEElo8jcmsHfUoI1w9*3UKUqP7bWpaeU!/b&bo=qQGjAAAAAAADFzk!&rf=viewer_4)

每个图像特征的glimpse $x_c$是图像特征在所有空间位置的加权平均，注意力权值$a_{c,l}$对每个glimpse分别归一化，F是一个两层的卷积，共享第一层参数，仅依靠不同的初始化来产生不同的注意力分布

### Classifier

最后将图像注意力和LSTM结果连接，输入到分类器(两层全连接层)，损失函数为

![](http://m.qpic.cn/psc?/V10nbMUG3EIcUi/TmEUgtj9EK6.7V8ajmQrEJ94Wlne3AsVjjuTDZmFUAD8lYK7UVkOzkb5r8gy7guTfzEvQhSuue1ixVTVVJ0UsGwjcY6m8zP9sBodl45bWBU!/b&bo=bQFyAAAAAAADFyw!&rf=viewer_4)

## Experiments

消融实验

![](http://m.qpic.cn/psc?/V10nbMUG3EIcUi/TmEUgtj9EK6.7V8ajmQrEMDJYV20riAtFlF6xuGJJKzUH3KGcbsZrRW4X7IeiZfAnJNuGIVRVY3jOO2B0GHAwANbrloA18MfNVdc3EqFl3g!/b&bo=wQSJAgAAAAADJ0w!&rf=viewer_4)

VQA1.0上和SOTA的比较

![](http://m.qpic.cn/psc?/V10nbMUG3EIcUi/TmEUgtj9EK6.7V8ajmQrEPuhgqNt*GqPcEyQXURNGyPhZsA9K2gR0pUeXo3UcvpzYU8QdqOwn4t.IVZg2Vk87H1uSr8cBYkUebrgvOcxUbg!/b&bo=qwSEAQAAAAADFxg!&rf=viewer_4)

VQA2.0上的表现

![](http://m.qpic.cn/psc?/V10nbMUG3EIcUi/TmEUgtj9EK6.7V8ajmQrEOnt6LJwaT0Q7IcPv0aR4lYtEZuxZJIRS1Nnw2jxp63xNXJPOs5fpXs0qLha1ALmMCg5HLe.rTQPalPF0oIJ.3g!/b&bo=MAKQAAAAAAADF5A!&rf=viewer_4)

可视化展示

![](http://m.qpic.cn/psc?/V10nbMUG3EIcUi/TmEUgtj9EK6.7V8ajmQrEH3rCrK6QfyEDzWmvL.HagJ5aDkC8GFgB6ePf*b.YraCSLW16Q72DOZxIEwnFfZGJpYUoEeijJmH0zykqK4TdEQ!/b&bo=9ALQAgAAAAADNzY!&rf=viewer_4)


